{% extends 'theme/base.html' %}

{% block title %}Pedidos por Diâmetro{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold text-white mb-8">Pedidos por Diâmetro</h1>

<!-- Barra de Pesquisa -->
<div class="mb-4">
    <input type="text" id="searchInput" placeholder="Pesquisar pedidos..."
           class="w-full md:w-1/2 px-4 py-2 border rounded shadow focus:outline-none focus:ring focus:ring-blue-300" />
</div>

<!-- Tabela -->
<div class="overflow-x-auto w-full max-w-6xl bg-white rounded-lg shadow-lg p-6">
    <table class="min-w-full table-auto text-xs md:text-sm text-left" id="pedidoTable">
        <thead class="bg-blue-600 text-white uppercase font-semibold text-sm">
            <tr>
                <th class="px-4 py-3">ID</th>
                <th class="px-4 py-3">QR Code</th>
                <th class="px-4 py-3">Diâmetro</th>
                <th class="px-4 py-3">Série dos Dies</th>
                <th class="px-4 py-3">Nº de Fieiras</th>
                <th class="px-4 py-3">Pedido Por</th>
                <th class="px-4 py-3">Data de Criação</th>

            </tr>
        </thead>
        <tbody class="text-gray-800">
            {% for pedido in pedidos %}
            <tr class="border-b hover:bg-gray-100 transition-colors">
                <td class="px-4 py-2">{{ pedido.id }}</td>
                <td class="px-4 py-2">{{ pedido.qr_code }}</td>
                <td class="px-4 py-2">{{ pedido.diametro }}</td>
                <td class="px-4 py-2">{{ pedido.serie_dies }}</td>
                <td class="px-4 py-2">{{ pedido.numero_fieiras }}</td>
                <td class="px-4 py-2">{{ pedido.pedido_por }}</td>
                
                <td class="px-4 py-2">{{ pedido.created_at|date:"d/m/Y H:i" }}</td>

            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center text-gray-500 py-4">Nenhum pedido encontrado.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Script de filtro -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById('searchInput');
        const tableBody = document.getElementById('pedidoTable').getElementsByTagName('tbody')[0];

        searchInput.addEventListener('keyup', function () {
            const filter = searchInput.value.toLowerCase();
            const rows = tableBody.getElementsByTagName('tr');

            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;

                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toLowerCase().includes(filter)) {
                        found = true;
                        break;
                    }
                }
                rows[i].style.display = found ? '' : 'none';
            }
        });
    });
</script>
{% endblock %}
