{% extends 'theme/base.html' %}
{% block title %}Orders{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold text-white mb-8">Orders</h1>

<form method="POST" action="{% url 'orders' %}" enctype="multipart/form-data"
      class="bg-white p-6 rounded-lg shadow-md">
  {% csrf_token %}

  <div class="mb-4">
    <label for="tracking_number" class="block text-gray-700">Tracking Number</label>
    <input type="text" id="tracking_number" name="tracking_number"
           class="border border-gray-300 rounded-lg p-2 w-full" required>
  </div>

  <div class="mb-4">
    <label for="orders_coming" class="block text-gray-700">Orders Coming</label>
    <textarea id="orders_coming" name="orders_coming"
              class="border border-gray-300 rounded-lg p-2 w-full" required></textarea>
  </div>

  <div class="mb-4">
    <label for="courier" class="block text-gray-700">Courier</label>
    <select id="courier" name="courier" class="border border-gray-300 rounded-lg p-2 w-full">
      <option value="">Select Courier</option>
      {% for courier in courier_choices %}
        <option value="{{ courier }}">{{ courier }}</option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-4">
    <label for="shipping_date" class="block text-gray-700">Shipping Date</label>
    <input type="date" id="shipping_date" name="shipping_date"
           class="border border-gray-300 rounded-lg p-2 w-full">
  </div>

  <div class="mb-4">
    <label for="comment" class="block text-gray-700">Comment</label>
    <textarea id="comment" name="comment"
              class="border border-gray-300 rounded-lg p-2 w-full"></textarea>
  </div>

  <div class="mb-4">
    <label for="files" class="block text-gray-700">Upload Files</label>
    <input type="file" id="files" name="files" multiple
           class="border border-gray-300 rounded-lg p-2 w-full">

    <!-- Pré-visualização com checkbox "Restrito" por ficheiro -->
    <div id="file-list" class="mt-3 space-y-2"></div>
  </div>

  <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors">
    Submit Order
  </button>
</form>
{% endblock %}

{% block extra_js %}
<script>
  document.getElementById('files').addEventListener('change', function (e) {
    const fileList = document.getElementById('file-list');
    fileList.innerHTML = ''; // limpa antes

    const files = Array.from(e.target.files);
    files.forEach((file, index) => {
      const row = document.createElement('div');
      row.className = "flex items-center gap-3";

      row.innerHTML = `
        <span class="text-gray-700">${file.name}</span>
        <input type="checkbox" name="restricted_${index}" value="1"
               class="rounded border-gray-300 text-blue-600 focus:ring-blue-500">
        <label class="text-sm text-gray-600">Restrito</label>
      `;

      fileList.appendChild(row);
    });
  });
</script>
{% endblock %}
